# MEP-decomposition
## Background
Motor-evoked potentials (MEP) are an important response phenomenon in brain stimulation, such as transcranial magnetic stimulation (TMS). MEPs provide one of the few directly observable responses of the brain to stimuli. Furthermore, MEPs are a key to understanding the biophysical and neurophysiological mechanisms of brain stimulation, to establishing safety limits, to matching different devices or coils, and to achieving individual dosing. The so-called motor threshold is deﬁned based on MEPs as a low stimulation amplitude that generates first reliably detectable responses and is the key safety as well as dosage reference level.\
Conventionally, the amplitude of MEPs is quantified by their peak-to-peak voltage. Despite the simplicity, it is relatively insensitive to weak MEP waves but highly susceptible to noise. Since it uses positive and negative maxima, it is sensitive to outliers of distributions and converts also simple interferences and noises, such as additive Gaussian noise, into highly skewed and mathematically intricate extreme-value distributions. Strictly, those extreme-value distributions have to be considered for correct statistical analysis, but practically rarely are.
## Method
We assume that each MEP measurement comprises a volley of multiple motor unit action potentials (MUAPs) that share the same shape but with different latencies and amplitudes. Specifically,
$$s(t) = \sum_i{x_i\cdot v(t-\tau_i)+n(t), (x_i \geq 0, n \sim N(0,\sigma^2))}$$
where $s(t)$ is the MEP recording, $v$ the MUAP, $x_i$ the amplitudes of MUAPs at different time, $τ_i$ the latencies, and $n$ the i.i.d. Gaussian noise, while subscript $i$ enumerates the different possible latencies. For causal responses to the stimulus, we restrict to $x_i$ ≥ 0 for all possible latencies $i$. Thus, with known MUAP shape , we should ideally extract the population of MUAPs over time ($x_i$) for each MEP waveform. Per MEP, the MUAP populations reflect the amplitude of the MEP response.
## Files
`data.mat`  : example MEP data, 517 measurements with stimulation strengths.\
`main.m`    : the main program, including learning MUAP, decompostion, re-construction, and Vpp readings.
